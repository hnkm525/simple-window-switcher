{"ast":null,"code":"import _regeneratorRuntime from\"/home/honeycomb/workspace/simple-window-switcher/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/honeycomb/workspace/simple-window-switcher/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import'./App.css';import{useEffect}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var startButton=document.getElementById(\"startButton\");console.log(startButton);var localVideo;var audioCheck=document.getElementById('audio_check');var localStream=null;var playVideo=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(element,stream){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(\"element\",element);console.log(\"stream\",stream);element.srcObject=stream;_context.prev=3;_context.next=6;return element.play();case 6:_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](3);console.error(_context.t0);case 11:;case 12:case\"end\":return _context.stop();}}},_callee,null,[[3,8]]);}));return function playVideo(_x,_x2){return _ref.apply(this,arguments);};}();var onClickStart=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var option;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:option={video:{frameRate:60},audio:true};_context2.prev=1;_context2.next=4;return navigator.mediaDevices.getDisplayMedia(option).then(function(res){playVideo(localVideo,res);localStream=res;});case 4:console.log('mediaDevice.getDisplayMedia　Screen Capture OK');_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](1);console.error('mediaDevice.getDisplayMedia() error:',_context2.t0);case 10:case\"end\":return _context2.stop();}}},_callee2,null,[[1,7]]);}));return function onClickStart(){return _ref2.apply(this,arguments);};}();var onClickStop=function onClickStop(stream){cleanupVideoElement(localVideo);if(localStream){stopStream(localStream);localStream=null;}};var cleanupVideoElement=function cleanupVideoElement(element){element.pause();element.srcObject=null;};var stopStream=function stopStream(stream){stream.getTracks().forEach(function(track){return track.stop();});};useEffect(function(){var startButton=document.getElementById(\"startButton\");console.log(startButton);startButton.disabled=false;localVideo=document.getElementById('video');},[]);return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsxs(\"header\",{className:\"App-header\",children:[/*#__PURE__*/_jsxs(\"div\",{id:\"container\",children:[/*#__PURE__*/_jsx(\"button\",{id:\"startButton\",onClick:onClickStart,children:\"Start\"}),/*#__PURE__*/_jsx(\"button\",{id:\"startButton\",onClick:onClickStop,children:\"Stop\"})]}),/*#__PURE__*/_jsx(\"video\",{className:\"video\",id:\"video\",autoPlay:true,muted:true})]})});}export default App;","map":{"version":3,"sources":["/home/honeycomb/workspace/simple-window-switcher/src/App.tsx"],"names":["useEffect","App","startButton","document","getElementById","console","log","localVideo","audioCheck","localStream","playVideo","element","stream","srcObject","play","error","onClickStart","option","video","frameRate","audio","navigator","mediaDevices","getDisplayMedia","then","res","onClickStop","cleanupVideoElement","stopStream","pause","getTracks","forEach","track","stop","disabled"],"mappings":"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","sourcesContent":["import './App.css';\nimport { useEffect } from \"react\"\n\nfunction App() {\n\n  const startButton: any = document.getElementById(\"startButton\");\n  console.log(startButton);\n\n  let localVideo: any;\n  const audioCheck = document.getElementById('audio_check');\n  let localStream: any = null;\n\n\n  const playVideo = async (element: any, stream: any) => {\n    console.log(\"element\", element);\n    console.log(\"stream\", stream);\n    \n\n    element.srcObject = stream;\n    try {\n      await element.play();\n    }\n    catch (err) {\n      console.error(err)\n    };\n  }\n\n  const onClickStart = async () => {\n    const option = { video: { frameRate: 60 }, audio: true };\n    try {\n      await navigator.mediaDevices.getDisplayMedia(option)\n      .then((res)=>{\n        playVideo(localVideo, res);\n        localStream = res;\n      });\n      console.log('mediaDevice.getDisplayMedia　Screen Capture OK');\n    } catch (err) {\n      console.error('mediaDevice.getDisplayMedia() error:', err);\n    }\n  }\n\n  const onClickStop = (stream:any) => {\n    cleanupVideoElement(localVideo);\n    if (localStream) {\n      stopStream(localStream);\n      localStream = null;\n    }\n  }\n\n  const cleanupVideoElement = (element:any) => {\n    element.pause();\n    element.srcObject = null;\n  }\n\n  const stopStream = (stream: any) => {\n    stream.getTracks().forEach((track: any) => track.stop());\n  }\n\n  useEffect(() => {\n    const startButton: any = document.getElementById(\"startButton\");\n    console.log(startButton);\n    startButton.disabled = false;\n    localVideo = document.getElementById('video');\n  }, [])\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <div id=\"container\">\n          <button id=\"startButton\" onClick={onClickStart}>Start</button>\n          <button id=\"startButton\" onClick={onClickStop}>Stop</button>\n        </div>\n        <video className=\"video\" id=\"video\" autoPlay muted={true}></video>\n      </header>\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}